# housing-sim-jp

**20〜40代・世帯年収1,000〜2,000万の共働きカップル**が、マンション購入・一戸建て購入・賃貸のどれが最も資産形成に有利かを、80歳までの月次シミュレーションで比較するツール。

物件価格・家賃は**さいたま市浦和区の実勢価格**（2026年）をハードコードしており、都心タワマンや地方物件には対応していない。初期資産3億超（浦和最高級物件が現金購入可能な水準）や世帯年収600万以下の世帯は想定外。確定論（固定リターン）とMonte Carlo（確率分布+生活イベントリスク）の2モードを持つ。

## 比較戦略

| 戦略 | 概要 |
|------|------|
| **浦和マンション** | 築10年中古マンション購入（7,580万円）。管理費+修繕積立金が築年数で段階増額 |
| **浦和一戸建て** | 築7年中古一戸建て購入（6,547万円）。大規模修繕を一時費用で計上 |
| **戦略的賃貸** | ライフステージに応じて3フェーズで家賃ダウンサイジング（2LDK→3LDK→2LDK） |
| **通常賃貸** | 3LDK固定で全期間賃貸 |

## 使い方

```bash
# 確定論シミュレーション（4戦略比較）
python -m housing_sim_jp.cli
python -m housing_sim_jp.cli --husband-age 37 --wife-age 35 --savings 1500 --husband-income 45 --wife-income 30
python -m housing_sim_jp.cli --pets 38,40 --car                       # ペット2匹+車
python -m housing_sim_jp.cli --children none --education-grad 修士     # 子なし / 大学院進学

# 5シナリオ×4戦略比較（低成長/標準/高成長/慢性スタグフレーション/サイクル型 + 投資規律の感度分析）
python -m housing_sim_jp.scenario_cli

# Monte Carlo（N=1,000試行 + イベントリスク）
python -m housing_sim_jp.monte_carlo_cli
python -m housing_sim_jp.monte_carlo_cli --stress-test                # ストレステスト追加出力

# チャート生成（確定論+MC → reports/charts/）
python -m housing_sim_jp.chart_cli
python -m housing_sim_jp.chart_cli --no-mc                            # 確定論のみ（高速）

# レポート自動生成（7章構成Markdown: 確定論+シナリオ+MC+ストレステスト統合）
python -m housing_sim_jp.report_cli --config config.example-30.toml --name 30
python -m housing_sim_jp.report_cli --all                             # 4設定一括
python -m housing_sim_jp.report_cli --no-mc                           # MC省略（高速）

# テスト
python -m pytest tests/ -v
```

全オプションは各CLIの `--help` を参照。

### 設定ファイル

`config.example-*.toml` をコピーして `config.toml` を作成すると、CLIフラグのデフォルト値を上書きできます。

```bash
cp config.example-25.toml config.toml   # 25歳プリセット（250万/手取り57万/子2人/生活費P3万）
cp config.example-30.toml config.toml   # 30歳プリセット（600万/手取り67万/子2人/生活費P3万/ペット1匹）
cp config.example-35.toml config.toml   # 35歳プリセット（1200万/手取り74万/子1人/生活費P3万/中学〜私立理系/車）
python -m housing_sim_jp.cli                              # config.toml を自動読み込み
python -m housing_sim_jp.cli --config my_config.toml      # 任意のパスを指定
python -m housing_sim_jp.cli --config config.toml --husband-age 40  # CLIフラグで個別に上書き
```

**優先順位**: CLIフラグ > config.toml > ハードコードデフォルト

## 前提条件

- **世帯**: 一都三県勤務の共働きカップル（夫婦別年齢）、大手企業正社員。浦和駅エリア想定
- **収入**: 夫婦各人の月額手取りに、5段階キャリアカーブ（55歳ピーク）× 名目賃金上昇率を重畳。60歳再雇用、70歳年金生活
- **住宅**: 2026年浦和実勢価格。フルローン35年変動金利（5年ごとステップ式）、銀行審査基準（年収倍率≤7倍、返済比率≤35%）適用
- **教育**: 4トラック（国立文系/理系・私立文系/理系）の年次コストスケジュール。学部計1,200万〜1,900万。大学院進学対応
- **運用**: iDeCo → NISA（夫婦合計3,600万上限）→ 特定口座の順で投資。退職5年前からバケット戦略（現金2年分+債券3年分+ゴールド10%）で安全資産を積み増し、取り崩しは現金→債券→ゴールド→株式の順
- **出口**: 80歳で老人ホーム入居。金融資産と年金から施設グレード（S〜D）を判定

## 経済シナリオ

| パラメータ | 低成長 | 標準 | 高成長 | 慢性スタグフレーション | サイクル型 * |
|-----------|--------|------|--------|----------------------|------------|
| インフレ率 | 1.0% | 2.0% | 3.0% | 2.0% | 2.3% |
| 賃金上昇率 | 1.0% | 2.0% | 3.0% | 1.5% | 1.7% |
| 実質賃金 | ±0% | ±0% | ±0% | -0.5% | -0.6% |
| 運用利回り | 5.0% | 6.0% | 7.5% | 4.5% | 5.1% |
| 土地上昇率 | 0.0% | 0.75% | 1.5% | 0.0% | 0.2% |
| ローン金利 | 0.50→1.25% | 0.75→2.50% | 1.25→3.50% | 0.75→2.25% | 0.90→2.75% |

\* **サイクル型**: 7年通常（利回り6.0%/インフレ2.0%/賃金2.0%）+ 3年スタグフレーション（利回り3.0%/インフレ3.0%/賃金1.0%）の10年サイクル。表中の値は加重平均。投資リターンのみ年次変動あり。

## Monte Carlo

確定論（固定リターン6.0%）では見えない**市場変動リスク**と**生活イベントリスク**を定量化する。投資リターンは対数正規分布（σ=15%）で年ごとに変動し、インフレ・金利・賃金は相関付き正規分布でラン単位に変動。生活イベント（失業・災害・介護・離婚・配偶者死亡・転勤等）を確率的に発生させ、P5〜P95のパーセンタイル分布・破綻確率・ストレステスト結果を出力する。

## 分析レポート

| レポート | 条件 |
|---------|------|
| [reports/report-25.md](reports/report-25.md) | 夫25歳/妻24歳・金融資産250万・手取り57万（夫34+妻23）・子2人（妻27,30歳出産）・高校〜私立理系・生活費P3万 |
| [reports/report-30.md](reports/report-30.md) | 夫30歳/妻28歳・金融資産600万・手取り67万（夫40+妻27）・子2人（妻31,33歳出産）・高校〜私立理系・生活費P3万・ペット1匹 |
| [reports/report-35.md](reports/report-35.md) | 夫35歳/妻32歳・金融資産1200万・手取り74万（夫44+妻30）・子1人（妻35歳出産）・中学〜私立理系・生活費P3万・車 |
